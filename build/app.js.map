{"version":3,"sources":["../server/app.js"],"names":["app","server","http","Server","bodyParser","require","bundler","Bundler","path","resolve","__dirname","mongoose","conString","Promise","Crono","model","user","String","h","Number","m","s","connect","err","console","log","use","json","urlencoded","extended","req","res","next","header","listen","process","env","PORT","address","port","find","sort","limit","exec","cronos","send","post","body","crono","save","status","error","middleware"],"mappings":";;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAJA;AAQA,IAAMA,MAAM,wBAAZ;AACA,IAAMC,SAASC,eAAKC,MAAL,CAAYH,GAAZ,CAAf;AACA,IAAMI,aAAaC,QAAQ,aAAR,CAAnB;AACA,IAAMC,UAAU,IAAIC,uBAAJ,CAAYC,eAAKC,OAAL,CAAaC,SAAb,EAAwB,sBAAxB,CAAZ,CAAhB;;AAOA;AACA,IAAIC,WAAWN,QAAQ,UAAR,CAAf;AACA,IAAIO,YAAY,0DAAhB;AACAD,SAASE,OAAT,GAAmBA,OAAnB;AACA,IAAIC,QAAQH,SAASI,KAAT,CAAe,OAAf,EAAwB;AAChCC,UAAKC,MAD2B;AAEhCC,OAAGC,MAF6B;AAGhCC,OAAGD,MAH6B;AAIhCE,OAAGF;AAJ6B,CAAxB,CAAZ;AAMAR,SAASW,OAAT,CAAiBV,SAAjB,EAA4B,UAACW,GAAD,EAAS;AACjC,QAAGA,GAAH,EAAO;AACHC,gBAAQC,GAAR,CAAY,+BAA+BF,GAA3C;AACH,KAFD,MAEK;AACDC,gBAAQC,GAAR,CAAY,yBAAZ;AACH;AAEJ,CAPD;;AAcA;AACAzB,IAAI0B,GAAJ,CAAQtB,WAAWuB,IAAX,EAAR;AACA3B,IAAI0B,GAAJ,CAAQtB,WAAWwB,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;AACA7B,IAAI0B,GAAJ,CAAQ,UAASI,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC7BD,QAAIE,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACAF,QAAIE,MAAJ,CAAW,8BAAX,EAA2C,gDAA3C;AACAD;AACD,CAJH;;AAMA/B,OAAOiC,MAAP,CAAcC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAlC,EAAwC,YAAW;AAC/Cb,YAAQC,GAAR,yBAAkCxB,OAAOqC,OAAP,GAAiBC,IAAnD;AACH,CAFD;;AAKAvC,IAAI0B,GAAJ,CAAQ,WAAR,EAAqB,UAACI,GAAD,EAAMC,GAAN,EAAa;AAC9BjB,UAAM0B,IAAN,CAAW,EAAX,EAAeC,IAAf,CAAoB,EAACvB,GAAE,CAAH,EAAKE,GAAE,CAAP,EAASC,GAAE,CAAX,EAApB,EAAmCqB,KAAnC,CAAyC,CAAzC,EAA4CC,IAA5C,CAAiD,UAASpB,GAAT,EAAcqB,MAAd,EAAsB;AAAEb,YAAIc,IAAJ,CAASD,MAAT;AAAmB,KAA5F;AAEH,CAHD;;AAKA5C,IAAI8C,IAAJ,CAAS,OAAT,EAAkB,UAAUhB,GAAV,EAAeC,GAAf,EAAmB;AACjCP,YAAQC,GAAR,CAAYK,IAAIiB,IAAhB;AACA,QAAI;AACA,YAAIC,QAAQ,IAAIlC,KAAJ,CAAUgB,IAAIiB,IAAd,CAAZ;AACAC,cAAMC,IAAN;AACAlB,YAAImB,MAAJ,CAAW,GAAX,EAAgBL,IAAhB,CAAqB,OAArB;AACH,KAJD,CAIE,OAAOM,KAAP,EAAc;AACZpB,YAAImB,MAAJ,CAAW,GAAX,EAAgBL,IAAhB,CAAqB,OAArB;AACArB,gBAAQC,GAAR,CAAY0B,KAAZ;AACH;AACJ,CAVD;;AAYAnD,IAAI0B,GAAJ,CAAQpB,QAAQ8C,UAAR,EAAR","file":"app.js","sourcesContent":["/*jshint esversion:6*/\nimport express from 'express';\nimport Bundler from 'parcel-bundler';\nimport path from 'path';\nimport http from 'http';\n\n\n\nconst app = express();\nconst server = http.Server(app);\nconst bodyParser = require(\"body-parser\");\nconst bundler = new Bundler(path.resolve(__dirname, '../client/index.html'));\n\n\n\n\n\n\n//BBDD\nvar mongoose = require(\"mongoose\")\nvar conString = \"mongodb://admin:rootadmin1@ds259111.mlab.com:59111/crono\";\nmongoose.Promise = Promise;\nvar Crono = mongoose.model(\"Crono\", {\n    user:String,\n    h: Number,\n    m: Number,\n    s: Number\n});\nmongoose.connect(conString, (err) => {\n    if(err){\n        console.log(\"Database connection error:\" + err);\n    }else{\n        console.log(\"Database connection OK.\");\n    }\n    \n});\n\n\n\n\n\n\n// SERVER SETTINGS\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(function(req, res, next) {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n    next();\n  });\n\nserver.listen(process.env.PORT || 8080, function() {\n    console.log(`Listening on port: ${server.address().port}`);\n});\n\n\napp.use('/getTimes', (req, res) =>{\n    Crono.find({}).sort({h:1,m:1,s:1}).limit(7).exec(function(err, cronos) { res.send(cronos); });\n    \n});\n\napp.post(\"/time\", function (req, res){\n    console.log(req.body);\n    try {\n        var crono = new Crono(req.body)\n        crono.save()\n        res.status(200).send('saved');\n    } catch (error) {\n        res.status(500).send('error');\n        console.log(error);\n    }\n})\n\napp.use(bundler.middleware());"]}