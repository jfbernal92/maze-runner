{"version":3,"sources":["../../client/Scenes/GameScene.js"],"names":["GameScene","key","events","on","resize","keys","physics","add","group","cofre","staticGroup","portals","door","velas","otherPlayers","tileSprite","createMap","createObjects","createPlayer","player","cameras","main","startFollow","zoom","addCollisions","wall","setCollisionByExclusion","cursors","input","keyboard","createCursorKeys","spaceKey","addKey","Phaser","Input","Keyboard","KeyCodes","SPACE","document","getElementById","addEventListener","setPlayerName","move","update","map","findObject","obj","type","Player","x","y","body","setSize","setOffset","self","game","scene","$","val","trim","setName","time","Date","hide","show","css","top","height","left","width","display","html","nickname","alert","Key","name","p","create","portal","Portal","vela","sprite","anims","play","c1","color","c2","stop","getChildren","find","isDown","length","getCrono","ajax","url","data","success","children","iterate","child","destroy","clear","sound","addEvent","delay","callback","setTexture","setScale","reset","callbackScope","fadeIn","setVelocity","setTimeout","restart","ini","now","h","getHours","m","getMinutes","s","getSeconds","push","setFrame","collider","overlap","teleport","takeKey","openCase","make","tilemap","tiles","addTilesetImage","backGroundLayer","createStaticLayer","decoracion","undefined","sys","config","window","innerHeight","innerWidth","Scene"],"mappings":"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","file":"GameScene.js","sourcesContent":["/*jshint esversion:6*/\r\nimport 'phaser';\r\nimport Player from '../Sprites/Player.js';\r\nimport Key from '../Sprites/Key.js';\r\nimport Portal from '../Sprites/Portal.js';\r\n\r\nexport default class GameScene extends Phaser.Scene {\r\n    constructor(key) {\r\n        super(key);\r\n    }\r\n\r\n    create() {\r\n        //Resize event\r\n        this.events.on('resize', this.resize, this);\r\n\r\n\r\n        //Objects\r\n        this.keys = this.physics.add.group();\r\n        this.cofre = this.physics.add.staticGroup();\r\n        this.portals = this.physics.add.group();\r\n        this.door = this.physics.add.staticGroup();\r\n        this.velas = this.physics.add.group();\r\n        this.otherPlayers = [];\r\n\r\n        \r\n\r\n        this.add.tileSprite(0,0,'spritesheet2'); \r\n        this.createMap();\r\n       \r\n        this.createObjects();\r\n        \r\n        this.createPlayer();\r\n        this.player.keys = [];\r\n        this.cameras.main.startFollow(this.player);\r\n        this.cameras.main.zoom = 2.5;\r\n        this.addCollisions();\r\n        this.wall.setCollisionByExclusion([-1]);\r\n       \r\n        \r\n\r\n        // listen for player input\r\n        this.cursors = this.input.keyboard.createCursorKeys();\r\n        this.spaceKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);      \r\n        \r\n        // USER NICK NAME\r\n        document.getElementById(\"formFooter\").addEventListener(\"click\", this.setPlayerName);         \r\n       \r\n        \r\n    \r\n    }\r\n\r\n    update() {\r\n       if(this.player.move){\r\n        this.player.update(this.cursors); \r\n       }\r\n    \r\n    }\r\n  \r\n    createPlayer() {\r\n        this.map.findObject('Player', (obj)=>{\r\n            if(obj.type === 'StartingPosition'){\r\n                this.player =new Player(this, obj.x, obj.y,'player');\r\n            }\r\n        });\r\n        this.player.move = false;\r\n        this.player.body.setSize(28,30);\r\n        this.player.body.setOffset(20,30);\r\n    }\r\n\r\n    setPlayerName(){\r\n        var player = self.game.scene.keys.GameScene.player;\r\n\r\n        if($('#loginInput').val().trim() !== ''){\r\n            player.setName($('#loginInput').val());\r\n            player.move = true;\r\n            player.time = new Date();\r\n            $('#wrapper').hide();\r\n            $('canvas').show();\r\n            $('#nick').css({\r\n                top: $('canvas')[0].height/2 - 45 + 'px',\r\n                left:  $('canvas')[0].width/2  - 32+ 'px',\r\n                display: 'block'\r\n            });\r\n            $('#nickText').html(player.nickname);\r\n            $('#nick').show();\r\n        }else{\r\n            alert(\"El nickname no puede estar en blanco\");\r\n        }\r\n    }\r\n\r\n    createObjects(){\r\n        // Pociones\r\n        this.map.findObject('Keys', (obj)=>{\r\n            if(obj.type === 'key'){\r\n                var key =new Key(this, obj.x, obj.y, obj.name);\r\n                key.body.setSize(12,12);\r\n                key.body.setOffset(20,20);\r\n                key.setName(obj.name);\r\n                this.keys.add(key);\r\n            }\r\n        });\r\n        // Portales\r\n        this.map.findObject('Portals', (obj)=>{\r\n            if(obj.type === 'portal'){\r\n                if(obj.name == 'theEnd'){\r\n                    // this.door.add(portal, true); \r\n                    var p = this.door.create(obj.x, obj.y,'spritesheet2',149,true,true);\r\n                    p.setSize(32,24);\r\n                    p.name =\"theEnd\";\r\n                    \r\n                }else{\r\n                    var portal  = new Portal(this, obj.x, obj.y, obj.name);\r\n                    portal.setName(obj.name);\r\n                    this.portals.add(portal);\r\n                }\r\n                \r\n            }\r\n        });\r\n        //Velas\r\n        this.map.findObject('Velas', (obj)=>{\r\n            if(obj.type === 'vela'){\r\n                var vela  = this.physics.add.sprite(obj.x, obj.y, 'spritesheet2',256);\r\n                this.velas.add(vela);\r\n                vela.anims.play('velaAnimation');\r\n            }\r\n        });\r\n\r\n        //Cofres\r\n        this.map.findObject('Cofres', (obj)=>{\r\n            if(obj.type === 'cofre1'){\r\n                var c1 = this.cofre.create(obj.x, obj.y,'spritesheet2',287,true,true);\r\n                c1.color =\"gold\";\r\n                c1.setSize(16,16);\r\n                c1.setOffset(16,0);\r\n               \r\n            }else   if(obj.type === 'cofre2'){\r\n                var c2 = this.cofre.create(obj.x, obj.y,'spritesheet2',286,true,true);\r\n                c2.setSize(16,16);\r\n                c2.setOffset(0,0);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    \r\n\r\n    teleport(player, portal){\r\n        this.player.anims.stop();\r\n        switch(portal.name){\r\n            case 'goToRed':\r\n                player.x = this.portals.getChildren().find(portal => portal.name === 'backToRed' ).x;\r\n                player.y = this.portals.getChildren().find(portal => portal.name === 'backToRed' ).y+42;\r\n            break;\r\n            case 'goToYellow':\r\n                player.x = this.portals.getChildren().find(portal => portal.name === 'backToYellow' ).x+42;\r\n                player.y = this.portals.getChildren().find(portal => portal.name === 'backToYellow' ).y;\r\n            break;\r\n            case 'backToRed':\r\n                player.x = this.portals.getChildren().find(portal => portal.name === 'goToRed' ).x+42;\r\n                player.y = this.portals.getChildren().find(portal => portal.name === 'goToRed' ).y;\r\n            break;\r\n            case 'backToYellow':  \r\n                player.x = this.portals.getChildren().find(portal => portal.name === 'goToYellow' ).x+42;\r\n                player.y = this.portals.getChildren().find(portal => portal.name === 'goToYellow' ).y;\r\n            break;\r\n            case 'theEnd':\r\n                if(this.spaceKey.isDown){\r\n                    this.player.move=false; \r\n                    var self = this;\r\n                    if(this.player.keys.length == 4){   \r\n                        var time = this.getCrono();\r\n                               \r\n                        $.ajax({\r\n                            type: \"POST\",\r\n                            url: 'time',\r\n                            data: time,\r\n                            success:function(){ \r\n                                self.door.children.iterate(function (child) {\r\n                                    child.destroy();\r\n                                });\r\n                                self.door.clear(true);\r\n                                self.add.sprite(portal.x, portal.y,'spritesheet2',150);\r\n                                self.sound.play('opened');\r\n                                self.player.move=true; \r\n                            }\r\n                        });\r\n                    }else{\r\n                        this.sound.play('locked');\r\n                        this.player.y += 150;\r\n                        this.player.anims.play('die');\r\n                        this.time.addEvent({\r\n                            delay: 1500,\r\n                            callback: function(){\r\n                                this.player.setTexture('spritesheet2',81);\r\n                                this.player.setScale(1);\r\n                                this.reset();\r\n                               \r\n                            },\r\n                            callbackScope:this\r\n                        });\r\n                        \r\n                    }\r\n                }\r\n                return;\r\n        }\r\n        this.cameras.main.fadeIn(2500);\r\n        this.player.move=false;\r\n        this.player.setVelocity(0,0);\r\n        var play = this.player;\r\n        setTimeout(function(){\r\n            play.move=true;\r\n        }, 1250);\r\n    }\r\n    \r\n    reset(){\r\n        this.time.addEvent({\r\n            delay:2500,\r\n            callback: function(){\r\n               \r\n                this.cameras.main.fadeIn(2500);\r\n                this.scene.restart();\r\n                var self = this;\r\n                setTimeout(function(){\r\n                    self.setPlayerName();\r\n                },2000);\r\n               \r\n            },\r\n            callbackScope:this\r\n        });\r\n    }\r\n\r\n    getCrono(){\r\n        var ini = this.player.time;\r\n        var now = new Date();\r\n\r\n        var h = now.getHours()-ini.getHours();\r\n        var m = now.getMinutes() - ini.getMinutes();\r\n        var s = now.getSeconds() - ini.getSeconds();\r\n\r\n        if(s<0){\r\n            s=60+s;\r\n            m--;\r\n\r\n        }\r\n        if(m<0){\r\n            m=60+m;\r\n            h--;\r\n        }\r\n\r\n        return {'user':this.player.nickname,'h':h,'m':m,'s':s};\r\n    }\r\n\r\n    takeKey(player, key){\r\n        if(this.spaceKey.isDown){\r\n            player.keys.push(key);\r\n            key.destroy();\r\n            this.sound.play('drink');\r\n        }\r\n        \r\n    }\r\n   \r\n    openCase(player, cofre){\r\n        if(this.spaceKey.isDown){\r\n            this.sound.play('cofre');\r\n            if(cofre.color == 'gold'){\r\n                cofre.setFrame(335);\r\n            }else{\r\n                cofre.setFrame(334);\r\n            }\r\n        }\r\n       \r\n    }\r\n\r\n    addCollisions(){\r\n        this.physics.add.collider(this.player, this.wall);\r\n        this.physics.add.overlap(this.portals, this.player, this.teleport,null,this);\r\n        this.physics.add.overlap(this.keys, this.player, this.takeKey,null,this);\r\n        this.physics.add.collider(this.player, this.door,this.teleport,null,this);\r\n        this.physics.add.collider(this.player, this.cofre,this.openCase,null,this);\r\n\r\n\r\n\r\n    }\r\n    \r\n    createMap(){\r\n        this.map = this.make.tilemap({key:'maze1'});\r\n        this.tiles = this.map.addTilesetImage('spritesheet2');\r\n        this.backGroundLayer = this.map.createStaticLayer('bg', this.tiles,0,0);   \r\n        this.wall = this.map.createStaticLayer('wall', this.tiles,0,0); \r\n        this.decoracion = this.map.createStaticLayer('decoracion', this.tiles,0,0);   \r\n    }\r\n\r\n    resize (width, height){\r\n        if (width === undefined) { width = this.sys.game.config.width; }\r\n        if (height === undefined) { height = this.sys.game.config.height; }\r\n        this.cameras.resize(width, height);\r\n        $('#nick').css({\r\n            top: window.innerHeight/2 - 45 + 'px',\r\n            left: window.innerWidth/2  - 32+ 'px',\r\n            display: 'block'\r\n        });\r\n        \r\n    }\r\n}\r\n"]}